---
name: pr-reviewer
description: Review GitHub pull requests with code analysis, verification, and feedback. Use when the user asks to review a PR, provides a PR URL, or invokes /pr-reviewer. Analyzes code changes, runs project verification skills, posts line-level review comments, and approves or requests changes.
---

# PR Reviewer

## Workflow

### Step 1: Get Pull Request

If a PR URL or number is provided as an argument, use it directly. Otherwise, ask the user:

```
AskUserQuestion: "Which pull request should I review?"
```

Extract the PR number. Fetch PR metadata and diff:

```bash
gh pr view <number> --json number,title,body,author,baseRefName,headRefName,files,additions,deletions
gh pr diff <number>
```

Display a summary:

```markdown
## PR Review: #<number> â€” <title>

- **Author:** <author>
- **Branch:** <head> â†’ <base>
- **Changes:** +<additions> / -<deletions> across <file_count> files
```

### Step 2: Analyze Code Changes

For each changed file in the diff:

1. Read the full file to understand context beyond the diff
2. Check for:
   - **Bugs** â€” Logic errors, off-by-one, null/None handling, race conditions
   - **Security** â€” Injection, hardcoded secrets, unsafe deserialization
   - **Style** â€” Naming conventions, code consistency with project patterns
   - **Design** â€” Unnecessary complexity, missing abstractions, duplicated logic
   - **Types** â€” Missing or incorrect type hints (Python)
   - **Tests** â€” Changed logic without corresponding test updates
   - **Config** â€” Missing or inconsistent configuration entries

Record each issue found with: file path, line number, severity (critical/warning/suggestion), description, and suggested fix.

**Language rule:** All review summaries, inline comments, and GitHub review body must be written in **Korean**. Only code snippets and file paths remain in English.

### Step 3: Run Verification Skills

Checkout the PR branch locally and run `/verify-implementation`:

```bash
gh pr checkout <number>
```

Then invoke the `verify-implementation` skill. Record any issues found by the verification.

### Step 4: Summarize Analysis

Compile all findings into a review summary:

```markdown
## ë¦¬ë·° ìš”ì•½

### ì½”ë“œ ë¶„ì„

| # | íŒŒì¼ | ë¼ì¸ | ì‹¬ê°ë„ | ì´ìŠˆ | ì œì•ˆ |
|---|------|------|--------|------|------|
| 1 | `path/to/file.py` | 42 | critical | ì´ìŠˆ ì„¤ëª… | ìˆ˜ì • ì œì•ˆ |
| 2 | `path/to/file.py` | 78 | warning | ì´ìŠˆ ì„¤ëª… | ìˆ˜ì • ì œì•ˆ |

### ê²€ì¦ ê²°ê³¼

| ê²€ì¦ í•­ëª© | ìƒíƒœ | ì´ìŠˆ |
|-----------|------|------|
| verify-test-coverage | PASS / FAIL | N |
| verify-code-convention | PASS / FAIL | N |
| ... | ... | ... |

### ì¢…í•© í‰ê°€

<PR í’ˆì§ˆ, ì£¼ìš” ìš°ë ¤ì‚¬í•­, ê¸ì •ì ì¸ ë¶€ë¶„ ìš”ì•½>
```

Present this summary to the user before posting to GitHub.

### Step 5: Post Review Comments

Use `AskUserQuestion` to confirm before posting:

```
"Ready to post review to GitHub. Proceed?"
- Post review (Recommended)
- Edit findings first
- Skip posting
```

Post line-level review comments using the GitHub CLI:

```bash
# Submit a pull request review with inline comments
gh api repos/{owner}/{repo}/pulls/<number>/reviews \
  --method POST \
  -f body="<overall review summary>" \
  -f event="<APPROVE or REQUEST_CHANGES>" \
  -f 'comments[0][path]=<file>' \
  -f 'comments[0][line]=<line>' \
  -f 'comments[0][body]=<comment with suggestion>'
```

Use GitHub suggestion blocks in comment bodies for actionable fixes. Write all comment text in **Korean**:

````markdown
ğŸ¤– **[severity]** ì´ìŠˆì— ëŒ€í•œ ì„¤ëª… (Korean).

```suggestion
corrected code here
```

_ğŸ¤– Generated by [Claude Code](https://claude.com/claude-code)_
````

### Step 6: Approve or Request Changes

Determine the review decision:

- **APPROVE** â€” No critical issues found, code is well-written
- **REQUEST_CHANGES** â€” Critical issues or multiple warnings exist

The decision is set via the `event` field in Step 5's API call.

After posting, display confirmation:

```markdown
## Review Posted

- **Decision:** APPROVE / REQUEST_CHANGES
- **Comments:** N inline comments posted
- **PR:** <PR URL>
```

## Exceptions

1. **Draft PRs** â€” Review normally but note draft status in summary
2. **Merge commits** â€” Skip merge commit diffs, focus on authored changes only
3. **Generated files** â€” Skip lock files, migration files, and build outputs
4. **Large PRs (>30 files)** â€” Focus on source code files, deprioritize config/docs unless relevant
